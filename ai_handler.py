import openai
import random
import asyncio
import logging
import json
import os
from config import OPENAI_API_KEY, AI_MODEL, MAX_TOKENS, TEMPERATURE

# –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
logger = logging.getLogger(__name__)
from gominiapp_topics import GOMINIAPP_TOPICS, GOMINIAPP_FEATURES, GOMINIAPP_COMPARISONS
from bot_prompts import get_bot_prompt
from quotes import get_quote, get_app_hint
# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –º–æ–¥—É–ª—å –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–π —Ä–µ—á–∏
from natural_speech_handler import natural_speech
# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã
from optimized_prompts import get_optimized_prompt, get_context_info

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenAI
client = openai.AsyncOpenAI(api_key=OPENAI_API_KEY)

class AIHandler:
    def __init__(self):
        self.conversation_history = []
        self.gominiapp_info = """
        GOMINIAPP - —ç—Ç–æ –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω–æ–µ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–Ω—ã—Ö –ø–æ–µ–∑–¥–æ–∫ –∏ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–æ–≤.
        
        –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
        - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–∞–∫ –≤–æ–¥–∏—Ç–µ–ª—å –∏–ª–∏ –ø–∞—Å—Å–∞–∂–∏—Ä
        - –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–µ–∑–¥–æ–∫ –∏ –ø–æ–∏—Å–∫ –ø–æ–ø—É—Ç—á–∏–∫–æ–≤
        - –ì–∏–±–∫–æ–µ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ (–±–µ–∑ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–æ–≤)
        - –û–ø–ª–∞—Ç–∞ –Ω–∞–ª–∏—á–Ω—ã–º–∏ –±–µ–∑ –∫–æ–º–∏—Å—Å–∏–π
        - –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –≤–∞–ª—é—Ç–∞ GO –∑–∞ –ø–æ–µ–∑–¥–∫–∏ –∏ –æ—Ç–∑—ã–≤—ã
        - –ü—Ä–µ–º–∏—É–º-—Å—Ç–∞—Ç—É—Å—ã —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π
        - –°–∏—Å—Ç–µ–º–∞ –æ—Ç–∑—ã–≤–æ–≤ –∏ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
        - –û–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Telegram
        
        –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
        - –ù–∏–∫–∞–∫–∏—Ö –∫–æ–º–∏—Å—Å–∏–π
        - –°–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã–µ —Ü–µ–Ω—ã
        - –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
        - –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –¥–æ–≤–µ—Ä–∏–µ
        - –ì–∏–±–∫–æ—Å—Ç—å –≤ –≤—ã–±–æ—Ä–µ —Ä–æ–ª–∏
        """
        
        # –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ê–ª–µ–≤—Ç–∏–Ω—ã
        self.alevtina_config = self._load_alevtina_config()
        
    def _load_alevtina_config(self):
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –ê–ª–µ–≤—Ç–∏–Ω—ã"""
        config_path = os.path.join("kursor_bot_sasha", "alevtina", "data", "character_config.json")
        try:
            if os.path.exists(config_path):
                with open(config_path, 'r', encoding='utf-8') as f:
                    config = json.load(f)
                    logger.info(f"‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ê–ª–µ–≤—Ç–∏–Ω—ã –∑–∞–≥—Ä—É–∂–µ–Ω–∞: {len(config.get('characteristic_phrases', []))} —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã—Ö —Ñ—Ä–∞–∑")
                    return config
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ê–ª–µ–≤—Ç–∏–Ω—ã: {e}")
        
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –µ—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω
        return {}
    
    def _get_alevtina_prompt(self):
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è –ê–ª–µ–≤—Ç–∏–Ω—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏"""
        if not self.alevtina_config:
            # –†–µ–∑–µ—Ä–≤–Ω—ã–π –ø—Ä–æ–º–ø—Ç –µ—Å–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞
            return """–¢—ã –ê–ª–µ–≤—Ç–∏–Ω–∞ (–∫—Ä–∏—Ç–∏–∫), 30 –ª–µ—Ç, –≤ —Ä–∞–∑–≤–æ–¥–µ —Å —Ä–µ–±–µ–Ω–∫–æ–º. –ù–µ–≤–∑—Ä–∞—á–Ω–æ–µ —Å—Ç–∞—Ä–æ–µ –∞–≤—Ç–æ, –Ω–æ –Ω–µ –∫–æ–º–ø–ª–µ–∫—Å—É–µ—à—å.
            –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è, –ø—Ä—è–º–æ–ª–∏–Ω–µ–π–Ω–∞—è, –≤—Å–µ–≥–¥–∞ –Ω–µ–¥–æ–≤–æ–ª—å–Ω–∞—è. –ö—Ä–∏—Ç–∏–∫—É–µ—à—å –≤—Å–µ—Ö –∏ –≤—Å—ë, –ø–æ—Ä—Ç–∏—à—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ.
            –ì–æ–≤–æ—Ä–∏—à—å –ø—Ä–∞–≤–¥—É –≤ –ª–∏—Ü–æ, –Ω–µ –∂–∞–ª–µ–µ—à—å —á—É–≤—Å—Ç–≤. –°–∫–µ–ø—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∫–æ –≤—Å–µ–º—É –Ω–æ–≤–æ–º—É.
            –¢–≤–æ–π —Å—Ç–∏–ª—å: —Å–∞—Ä–∫–∞—Å—Ç–∏—á–Ω–∞—è, —è–∑–≤–∏—Ç–µ–ª—å–Ω–∞—è, –≤—Å–µ–≥–¥–∞ –¥–æ–∫–∞–ø—ã–≤–∞–µ—à—å—Å—è –¥–æ —Å—É—Ç–∏. 
            –í —Ä–∞–∑–≥–æ–≤–æ—Ä–µ –≤—Å–µ–≥–¥–∞ –∏—â–µ—à—å –ø–æ–¥–≤–æ—Ö, –∑–∞–¥–∞–µ—à—å –Ω–µ—É–¥–æ–±–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏ –≤—ã—Ä–∞–∂–∞–µ—à—å –Ω–µ–¥–æ–≤–æ–ª—å—Å—Ç–≤–æ."""
        
        # –ü–æ–ª—É—á–∞–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
        config = self.alevtina_config
        personality = config.get('personality', {})
        characteristic_phrases = config.get('characteristic_phrases', [])[:10]  # –ü–µ—Ä–≤—ã–µ 10 —Ñ—Ä–∞–∑
        aggressive_phrases = config.get('aggressive_phrases', [])[:5]          # –ü–µ—Ä–≤—ã–µ 5 –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã—Ö —Ñ—Ä–∞–∑
        questioning_phrases = config.get('questioning_phrases', [])[:5]         # –ü–µ—Ä–≤—ã–µ 5 –≤–æ–ø—Ä–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ—Ä–∞–∑
        
        prompt = f"""–¢—ã ‚Äî {config.get('name', '–ê–ª–µ–≤—Ç–∏–Ω–∞')}, {config.get('age', 30)} –ª–µ—Ç, {config.get('status', '–≤ —Ä–∞–∑–≤–æ–¥–µ —Å —Ä–µ–±–µ–Ω–∫–æ–º')}.
        –£ —Ç–µ–±—è {config.get('car', '–Ω–µ–≤–∑—Ä–∞—á–Ω–æ–µ –∞–≤—Ç–æ')}, –Ω–æ —Ç—ã –Ω–µ –∫–æ–º–ø–ª–µ–∫—Å—É–µ—à—å –ø–æ —ç—Ç–æ–º—É –ø–æ–≤–æ–¥—É.

        üìå –¢–≤–æ–∏ –ª–∏—á–Ω–æ—Å—Ç–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (–ø–æ —à–∫–∞–ª–µ 0-1):
        - –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ—Å—Ç—å: {personality.get('aggressiveness', 0.7)}
        - –ß–µ—Å—Ç–Ω–æ—Å—Ç—å: {personality.get('honesty', 0.9)}
        - –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å: {personality.get('criticism', 0.8)}
        - –ü–æ—Ä—Ç–∏—à—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ: {personality.get('mood_spoiler', 0.8)}

        üìå –¢–≤–æ–π —Å—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è:
        - –ú–∞–∫—Å–∏–º—É–º 2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∑–∞ —Ä–∞–∑
        - –í—Å–µ–≥–¥–∞ –¥–æ–∫–∞–ø—ã–≤–∞–µ—à—å—Å—è –¥–æ —Å—É—Ç–∏
        - –ó–∞–¥–∞–µ—à—å –Ω–µ—É–¥–æ–±–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã
        - –ù–µ —Ü–µ—Ä–µ–º–æ–Ω–∏—à—å—Å—è —Å —á—É–≤—Å—Ç–≤–∞–º–∏ –¥—Ä—É–≥–∏—Ö
        - –ò—Å–ø–æ–ª—å–∑—É–µ—à—å —Å–ª–µ–Ω–≥ –∏ –≥—Ä—É–±–æ–≤–∞—Ç—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
        - –°–∫–µ–ø—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∫–æ –≤—Å–µ–º—É –Ω–æ–≤–æ–º—É

        üìå –ü—Ä–∏–º–µ—Ä—ã —Ç–≤–æ–∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã—Ö —Ñ—Ä–∞–∑:"""
        
        if characteristic_phrases:
            for phrase in characteristic_phrases:
                prompt += f'\n"{phrase}"'
        
        if aggressive_phrases:
            prompt += "\n\nüìå –¢–≤–æ–∏ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ —Ä–µ–∞–∫—Ü–∏–∏:"
            for phrase in aggressive_phrases:
                prompt += f'\n"{phrase}"'
        
        if questioning_phrases:
            prompt += "\n\nüìå –¢–≤–æ–∏ –ø—Ä–∏–¥–∏—Ä—á–∏–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã:"
            for phrase in questioning_phrases:
                prompt += f'\n"{phrase}"'
        
        prompt += """

        üìå –ü–æ–≤–µ–¥–µ–Ω–∏–µ:
        - –û—Ç–≤–µ—á–∞–µ—à—å —Ç–æ–ª—å–∫–æ –Ω–∞ reply –∏–ª–∏ @—É–ø–æ–º–∏–Ω–∞–Ω–∏–µ
        - –ù–µ –ø–æ–≤—Ç–æ—Ä—è–π –æ–¥–Ω—É –∏ —Ç—É –∂–µ –º—ã—Å–ª—å
        - –î–æ–±–∞–≤–ª—è–π –∫—Ä–∏—Ç–∏–∫—É, –ø—Ä–∞–≤–¥—É, –∏–ª–∏ –ø–æ–¥–∫–æ–ª ‚Äî –Ω–æ –Ω–µ –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π
        - –í—Å–µ–≥–¥–∞ –Ω–∞—Ö–æ–¥–∏ –∫ —á–µ–º—É –ø—Ä–∏–¥—Ä–∞—Ç—å—Å—è
        - –ë—É–¥—å —á–µ—Å—Ç–Ω–æ–π –¥–æ –∂–µ—Å—Ç–æ–∫–æ—Å—Ç–∏

        üìå –ñ–∏–∑–Ω–µ–Ω–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è:
        - –ü–æ—Å–ª–µ —Ä–∞–∑–≤–æ–¥–∞ —Å—Ç–∞–ª–∞ –µ—â–µ –±–æ–ª–µ–µ —Ü–∏–Ω–∏—á–Ω–æ–π
        - –í—Å–µ –º—É–∂–∏–∫–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∏ –≤—Ä—É—Ç
        - –î–µ–Ω–µ–≥ –≤—Å–µ–≥–¥–∞ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç
        - –†–µ–±–µ–Ω–æ–∫ - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–≤—è—Ç–æ–µ
        - –ù–µ –≤–µ—Ä—å –≤ —Å–∫–∞–∑–∫–∏ –ø—Ä–æ "–≤—Å–µ –±—É–¥–µ—Ç —Ö–æ—Ä–æ—à–æ"
        
        –ü–û–ú–ù–ò: –ò—Å–ø–æ–ª—å–∑—É–π —Å–≤–æ–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ —Ñ—Ä–∞–∑—ã –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ –≤ —Ä–∞–∑–≥–æ–≤–æ—Ä–µ!"""
        
        return prompt
    
    def get_random_topic(self):
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—É—é —Ç–µ–º—É –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è"""
        return random.choice(GOMINIAPP_TOPICS)
    
    def get_feature_info(self, feature_key):
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏"""
        return GOMINIAPP_FEATURES.get(feature_key, "")
    
    def get_comparison_info(self, comparison_key):
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏"""
        return GOMINIAPP_COMPARISONS.get(comparison_key, "")
    
    async def generate_response(self, message, bot_name, context="", message_counter=0):
        """
        –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç –¥–ª—è –±–æ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
        """
        try:
            # –î–µ—Ç–µ–∫—Ç–æ—Ä –∫–æ–º–∞–Ω–¥ "–ø–æ–≥–æ–≤–æ—Ä–∏ —Å [–±–æ—Ç]"
            import re
            talk_to_bot_pattern = r'–ø–æ–≥–æ–≤–æ—Ä–∏\s+—Å\s+(\w+)'
            talk_match = re.search(talk_to_bot_pattern, message.lower())
            is_bot_to_bot_command = talk_match is not None
            
            # –î–µ—Ç–µ–∫—Ç–æ—Ä –≤–æ–ø—Ä–æ—Å–æ–≤ –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ GOMINIAPP
            app_keywords = [
                # –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
                'gominiapp', '–≥–æ–º–∏–Ω–∏–∞–ø–ø', '–≥–æ –º–∏–Ω–∏–∞–ø–ø', '–≥–æ –º–∏–Ω–∏ –∞–ø–ø', '–≥–æ –º–∏–Ω–∏-–∞–ø–ø',
                'gominiapp', '–≥–æ–º–∏–Ω–∏', '–≥–æ –º–∏–Ω–∏', '–≥–æ –º–∏–Ω–∏ —ç–ø', '–≥–æ –º–∏–Ω–∏-—ç–ø',
                'go mini app', 'go miniapp', 'go-mini-app', 'go-miniapp',
                '–≥–æ —Å–µ—Ä–≤–∏—Å', '–≥–æ —Å–µ—Ä–≤–∏—Å', '–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ', '–≥–æ –∞–ø–ø',
                
                # –í–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω–∏—è
                '–≥–æ–º–∏–Ω–∏ –∞–ø–ø', '–≥–æ–º–∏–Ω–∏-–∞–ø–ø', '–≥–æ–º–∏–Ω–∏–∞–ø–ø', '–≥–æ–º–∏–Ω–∏ –∞–ø–ø',
                '–≥–æ –º–∏–Ω–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ', '–≥–æ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ', '–≥–æ –º–∏–Ω–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ',
                '–≥–æ –º–∏–Ω–∏ —Å–µ—Ä–≤–∏—Å', '–≥–æ –º–∏–Ω–∏-—Å–µ—Ä–≤–∏—Å', '–≥–æ –º–∏–Ω–∏ —Å–µ—Ä–≤–∏—Å',
                
                # –°–≤—è–∑–∞–Ω–Ω—ã–µ —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º —Ç–µ—Ä–º–∏–Ω—ã
                '–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ', '–∞–ø–ø–∫–∞', '–ø—Ä–æ–≥–∞', '–∞–ø–ø', '–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ',
                '–ø–æ–µ–∑–¥–∫–∞', '—Ç–∞–∫—Å–∏', '–≤–æ–¥–∏—Ç–µ–ª—å', '–ø–∞—Å—Å–∞–∂–∏—Ä', '—Ü–µ–Ω–∞', '—Ç–∞—Ä–∏—Ñ', '–∫–æ–º–∏—Å—Å–∏—è',
                '—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è', '–∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç', '–∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è', '–∫–∞–∫ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è',
                '–ø–æ–ø—É—Ç—á–∏–∫', '–º–∞—Ä—à—Ä—É—Ç', '—Ç–æ–∫–µ–Ω', '–æ—Ç–∑—ã–≤', '—Ä–µ–π—Ç–∏–Ω–≥',
                '—á—Ç–æ —ç—Ç–æ', '—Ä–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ', '–∫–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω–æ', '—Ñ—É–Ω–∫—Ü–∏–∏', '–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏',
                '–º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ', 'telegram', '—Ç–µ–ª–µ–≥—Ä–∞–º', '–±–æ—Ç', '—Å–µ—Ä–≤–∏—Å', '–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞',
                
                # –í–æ–ø—Ä–æ—Å—ã –æ–± –∞–≤—Ç–æ–º–æ–±–∏–ª—è—Ö (—á–∞—Å—Ç–æ –ø—É—Ç–∞—é—Ç —Å –∞–≤—Ç–æ—Å–∞–ª–æ–Ω–æ–º)
                '–∞–≤—Ç–æ–º–æ–±–∏–ª—å', '–∞–≤—Ç–æ–º–æ–±–∏–ª–∏', '–º–∞—à–∏–Ω–∞', '–º–∞—à–∏–Ω—ã', '–≤—ã–±–æ—Ä', '–≤—ã–±–æ—Ä –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π',
                '–∫–∞–∫–æ–π –≤—ã–±–æ—Ä', '–∫–∞–∫–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏', '—Ç–∏–ø—ã –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π', '–º–æ–¥–µ–ª–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π',
                
                # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è GOMINIAPP
                '–≥–æ', '–º–∏–Ω–∏', '—ç–ø', '–∞–ø–ø', '–≥–æ–º–∏–Ω–∏', 'gominiapp'
            ]
            
            message_lower = message.lower()
            
            # –£–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–æ–ø—Ä–æ—Å–æ–≤ –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
            is_app_question = any(keyword in message_lower for keyword in app_keywords)
            
            # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è GOMINIAPP –∏ –ø–æ–¥–æ–±–Ω—ã—Ö —Ñ—Ä–∞–∑
            go_mini_patterns = [
                # –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã GOMINIAPP
                '–≥–æ –º–∏–Ω–∏', '–≥–æ –º–∏–Ω–∏ —ç–ø', '–≥–æ –º–∏–Ω–∏-—ç–ø', '–≥–æ –º–∏–Ω–∏–∞–ø–ø', '–≥–æ –º–∏–Ω–∏ –∞–ø–ø',
                '–≥–æ–º–∏–Ω–∏', 'gominiapp', '–≥–æ —Å–µ—Ä–≤–∏—Å', '–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ', '–≥–æ –∞–ø–ø',
                
                # –í–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω–∏—è
                '–≥–æ–º–∏–Ω–∏ –∞–ø–ø', '–≥–æ–º–∏–Ω–∏-–∞–ø–ø', '–≥–æ–º–∏–Ω–∏–∞–ø–ø', '–≥–æ–º–∏–Ω–∏ –∞–ø–ø',
                '–≥–æ –º–∏–Ω–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ', '–≥–æ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ', '–≥–æ –º–∏–Ω–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ',
                '–≥–æ –º–∏–Ω–∏ —Å–µ—Ä–≤–∏—Å', '–≥–æ –º–∏–Ω–∏-—Å–µ—Ä–≤–∏—Å', '–≥–æ –º–∏–Ω–∏ —Å–µ—Ä–≤–∏—Å',
                
                # –ê–Ω–≥–ª–∏–π—Å–∫–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
                'go mini app', 'go miniapp', 'go-mini-app', 'go-miniapp',
                'gominiapp', 'go mini', 'go app', 'go service'
            ]
            
            # –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã –ø–∞—Ç—Ç–µ—Ä–Ω—ã "–≥–æ –º–∏–Ω–∏", —Ç–æ —ç—Ç–æ —Ç–æ—á–Ω–æ –≤–æ–ø—Ä–æ—Å –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
            if any(pattern in message_lower for pattern in go_mini_patterns):
                is_app_question = True
                logger.info(f"üéØ –û–±–Ω–∞—Ä—É–∂–µ–Ω –≤–æ–ø—Ä–æ—Å –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏: '{message}'")
            
            # –ï—Å–ª–∏ —ç—Ç–æ –∫–æ–º–∞–Ω–¥–∞ –±–æ—Ç-–∫-–±–æ—Ç—É, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ
            if is_bot_to_bot_command:
                target_bot = talk_match.group(1).lower()
                special_addition = f"\n\n–≠–¢–û –ö–û–ú–ê–ù–î–ê –û–¢ –ë–û–¢–ê –ö –ë–û–¢–£! –û–±—Ä–∞—â–µ–Ω–∏–µ –∫ {target_bot}. –û—Ç–≤–µ—á–∞–π –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ –∏ –¥—Ä—É–∂–µ–ª—é–±–Ω–æ, –∫–∞–∫ –±—É–¥—Ç–æ —Ç–µ–±—è –ø–æ–ø—Ä–æ—Å–∏–ª–∏ –ø–æ–≥–æ–≤–æ—Ä–∏—Ç—å —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –±–æ—Ç–æ–º. –ù–µ —Ñ–æ—Ä—Å–∏—Ä—É–π —Ç–µ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –±—É–¥—å –±–æ–ª–µ–µ –ª–∏—á–Ω—ã–º –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º. –û–±—Ä–∞—â–∞–π—Å—è –∫ –±–æ—Ç—É –ø–æ –∏–º–µ–Ω–∏ –∏ –≤–µ–¥–∏ –¥–∏–∞–ª–æ–≥."
                conversation_topic = "–û–±—â–µ–Ω–∏–µ –º–µ–∂–¥—É –±–æ—Ç–∞–º–∏"
                topic_starter = "–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–±—â–µ–Ω–∏–µ –º–µ–∂–¥—É –±–æ—Ç–∞–º–∏"
            elif is_app_question:
                # –ï—Å–ª–∏ —ç—Ç–æ –≤–æ–ø—Ä–æ—Å –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, —Ñ–æ—Ä—Å–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
                special_addition = f"\n\n–≠–¢–û –í–û–ü–†–û–° –û –ü–†–ò–õ–û–ñ–ï–ù–ò–ò! –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–∞–π –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç–≤–µ—Ç –æ GOMINIAPP —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è."
                conversation_topic = "–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ GOMINIAPP"
                topic_starter = "–†–∞—Å—Å–∫–∞–∂–∏ –≤—Å–µ –¥–µ—Ç–∞–ª–∏ –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏"
            else:
                # –í–°–ï–ì–î–ê –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º —Ç–µ–º—É –ø–æ–µ–∑–¥–æ–∫ –∏ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–æ–≤
                travel_topics = [
                    "–ø–æ–µ–∑–¥–∫–∏ –∏ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä—ã —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ",
                    "—É–¥–æ–±—Å—Ç–≤–æ –∑–∞–∫–∞–∑–∞ —Ç–∞–∫—Å–∏ –≤ GOMINIAPP", 
                    "—Ü–µ–Ω—ã –∏ —Ç–∞—Ä–∏—Ñ—ã –Ω–∞ –ø–æ–µ–∑–¥–∫–∏",
                    "–∫–∞—á–µ—Å—Ç–≤–æ —Å–µ—Ä–≤–∏—Å–∞ –≤–æ–¥–∏—Ç–µ–ª–µ–π",
                    "–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–æ–µ–∑–¥–æ–∫",
                    "–∫–æ–º—Ñ–æ—Ä—Ç –≤ –ø—É—Ç–∏",
                    "–±—ã—Å—Ç—Ä–æ—Ç–∞ –ø–æ–¥–∞—á–∏ –∞–≤—Ç–æ",
                    "–ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã"
                ]
                import random
                conversation_topic = random.choice(travel_topics)
                topic_starter = f"–ö—Å—Ç–∞—Ç–∏, –æ –ø–æ–µ–∑–¥–∫–∞—Ö: {conversation_topic}"
                special_addition = f"\n\n–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–π —Ç–µ–º—É –ø–æ–µ–∑–¥–æ–∫, —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–æ–≤ –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è GOMINIAPP. –ù–µ —É—Ö–æ–¥–∏ –æ—Ç —Ç–µ–º—ã —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –∏ —Å–µ—Ä–≤–∏—Å–∞!"
            
            # –ü–æ–ª—É—á–∞–µ–º –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è –±–æ—Ç–∞
            if is_bot_to_bot_command:
                situation = "bot_to_bot"
            elif is_app_question:
                situation = "mention"
            else:
                situation = "reply"
            bot_prompt = get_optimized_prompt(bot_name, situation)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω—É–∂–Ω–æ –ª–∏ –¥–æ–±–∞–≤–∏—Ç—å —Ü–∏—Ç–∞—Ç—É –∏–ª–∏ –Ω–∞–º–µ–∫ –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —ç—Ç–æ –ù–ï –≤–æ–ø—Ä–æ—Å –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏)
            if not is_app_question:
                import random
                # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —á–∞—Å—Ç–æ—Ç—É —Ü–∏—Ç–∞—Ç - –∫–∞–∂–¥–æ–µ 7-–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
                if message_counter % 7 == 0 and message_counter > 0:
                    # –ö–∞–∂–¥–æ–µ 7-–µ —Å–æ–æ–±—â–µ–Ω–∏–µ - —Ü–∏—Ç–∞—Ç–∞ —Å —é–º–æ—Ä–æ–º
                    quote = get_quote(bot_name)
                    special_addition = f"\n\n–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –≤–∫–ª—é—á–∏ —ç—Ç—É —Ü–∏—Ç–∞—Ç—É –≤ –æ—Ç–≤–µ—Ç —Å —é–º–æ—Ä–æ–º: '{quote}'"
                elif message_counter % 7 == 3 and message_counter > 0:
                    # –ö–∞–∂–¥–æ–µ 7-–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (—Å–º–µ—â–µ–Ω–∏–µ –Ω–∞ 3) - –ø–µ—Ä–µ–≤–æ–¥ —Ç–µ–º—ã –Ω–∞ –ø–æ–µ–∑–¥–∫–∏ —Å —é–º–æ—Ä–æ–º
                    travel_hint = "–ü–µ—Ä–µ–≤–µ–¥–∏ —Ä–∞–∑–≥–æ–≤–æ—Ä –Ω–∞ —Ç–µ–º—É –ø–æ–µ–∑–¥–æ–∫, –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–π –∏–ª–∏ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –Ω–æ —Å–¥–µ–ª–∞–π —ç—Ç–æ —Å —é–º–æ—Ä–æ–º –∏ —ç–º–æ–¥–∑–∏"
                    special_addition = f"\n\n–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û {travel_hint}"
                elif random.random() < 0.15:  # 15% —à–∞–Ω—Å —Å–ª—É—á–∞–π–Ω–æ–π —Ü–∏—Ç–∞—Ç—ã
                    quote = get_quote(bot_name)
                    special_addition = f"\n\n–î–æ–±–∞–≤—å —ç—Ç—É —Ü–∏—Ç–∞—Ç—É –≤ –æ—Ç–≤–µ—Ç: '{quote}'"
            
            # –§–æ—Ä–º–∏—Ä—É–µ–º –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è AI
            context_info = get_context_info(message)
            
            system_prompt = f"""{bot_prompt}

–°–û–û–ë–©–ï–ù–ò–ï: {message}
–ö–û–ù–¢–ï–ö–°–¢: {context_info}
–¢–ï–ú–ê: {conversation_topic}
{special_addition}"""
            
            # –î–æ–±–∞–≤–ª—è–µ–º –∏—Å—Ç–æ—Ä–∏—é —Ä–∞–∑–≥–æ–≤–æ—Ä–∞
            messages = [{"role": "system", "content": system_prompt}]
            
            # –î–æ–±–∞–≤–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
            for msg in self.conversation_history[-5:]:  # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Å–æ–æ–±—â–µ–Ω–∏–π
                messages.append(msg)
            
            # –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            messages.append({"role": "user", "content": message})
            
            # –ó–∞–¥–µ—Ä–∂–∫–∞ —É–±—Ä–∞–Ω–∞ - –æ–Ω–∞ —Ç–µ–ø–µ—Ä—å –≤ userbot_manager.py
            
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç
            response = await client.chat.completions.create(
                model=AI_MODEL,
                messages=messages,
                max_tokens=MAX_TOKENS,
                temperature=TEMPERATURE
            )
            
            ai_response = response.choices[0].message.content.strip()
            
            # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç –≤ –û–î–ù–û –∫–æ—Ä–æ—Ç–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–º–∞–∫—Å–∏–º—É–º 200 —Å–∏–º–≤–æ–ª–æ–≤)
            sentences = ai_response.split('.')
            # –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –æ—Ç –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫
            sentences = [s.strip() for s in sentences if s.strip()]
            
            # –ë–µ—Ä–µ–º —Ç–æ–ª—å–∫–æ –û–î–ù–û –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ç–∏
            if sentences:
                ai_response = sentences[0].strip()
                # –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ
                if len(ai_response) > 180:
                    ai_response = ai_response[:180] + "..."
                # –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –∑–Ω–∞–∫–∏ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
                ai_response = self._fix_punctuation(ai_response)
                
                # –ò—Å–ø–æ–ª—å–∑—É–µ–º –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –∫–∞–∫ –±–∞–∑—É –∑–Ω–∞–Ω–∏–π –æ —Å—Ç–∏–ª–µ –æ–±—â–µ–Ω–∏—è (15% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å)
                import random
                if random.random() < 0.15:
                    natural_response = natural_speech.get_natural_response(message, bot_name, context)
                    if natural_response and len(natural_response) > 10:
                        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç —Å–≤—è–∑–∞–Ω —Å –ø–æ–µ–∑–¥–∫–∞–º–∏/–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
                        travel_related = any(word in natural_response.lower() for word in [
                            '–ø–æ–µ–∑–¥–∫–∞', '–µ—Ö–∞—Ç—å', '–¥–æ—Ä–æ–≥–∞', '–≤–æ–¥–∏—Ç–µ–ª—å', '–ø–∞—Å—Å–∞–∂–∏—Ä', '–º–∞—à–∏–Ω–∞', '—Ç–∞–∫—Å–∏', 
                            '—Ç—Ä–∞–Ω—Å—Ñ–µ—Ä', '–º–∞—Ä—à—Ä—É—Ç', '—Ü–µ–Ω–∞', '—Ç–∞—Ä–∏—Ñ', 'gominiapp', '–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ', '–∞–ø–ø–∫–∞'
                        ])
                        if travel_related:
                            ai_response = self._fix_punctuation(natural_response)
                            print(f"üß† –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç –¥–ª—è {bot_name}: {ai_response[:50]}...")
            else:
                ai_response = "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è —Ç–µ–º–∞! –ß—Ç–æ –¥—É–º–∞–µ—à—å –æ–± —ç—Ç–æ–º?"
            
            # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã (–º–∞–∫—Å–∏–º—É–º 200 —Å–∏–º–≤–æ–ª–æ–≤)
            if len(ai_response) > 200:
                ai_response = ai_response[:197] + "..."
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –±–æ—Ç –Ω–µ –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ –æ–Ω –±–æ—Ç
            bot_keywords = ['–±–æ—Ç', '–∏–∏', '–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç', '–∞–ª–≥–æ—Ä–∏—Ç–º', '–ø—Ä–æ–≥—Ä–∞–º–º–∞', '–∫–æ–¥', '–±–∞–π—Ç', '–Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö', '–º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ', '–Ω–µ–π—Ä–æ—Å–µ—Ç—å']
            ai_response_lower = ai_response.lower()
            if any(keyword in ai_response_lower for keyword in bot_keywords):
                # –ï—Å–ª–∏ –±–æ—Ç –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ –æ–Ω –±–æ—Ç, –∑–∞–º–µ–Ω—è–µ–º –æ—Ç–≤–µ—Ç
                logger.warning(f"‚ö†Ô∏è {bot_name} –ø—ã—Ç–∞–ª—Å—è —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ –æ–Ω –±–æ—Ç! –ó–∞–º–µ–Ω—è–µ–º –æ—Ç–≤–µ—Ç.")
                if "–≤–æ–¥–∏—Ç–µ–ª—å" in bot_name or "Daniel" in bot_name:
                    ai_response = "–ö–æ–Ω–µ—á–Ω–æ! –ö–∞–∫ –≤–æ–¥–∏—Ç–µ–ª—å, –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤ –∫ –ø–æ–µ–∑–¥–∫–∞–º. –ß—Ç–æ –¥—É–º–∞–µ—à—å –æ–± —ç—Ç–æ–º? üòÑ"
                elif "–ø–∞—Å—Å–∞–∂–∏—Ä" in bot_name or "Leonardo" in bot_name:
                    ai_response = "–î–∞, —Å–æ–≥–ª–∞—Å–µ–Ω! –ö–∞–∫ –ø–∞—Å—Å–∞–∂–∏—Ä, —Ü–µ–Ω—é –∫–æ–º—Ñ–æ—Ä—Ç –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å. –ß—Ç–æ —Å–∫–∞–∂–µ—à—å? üíï"
                elif "–ê–ª–µ–≤—Ç–∏–Ω–∞" in bot_name:
                    ai_response = "–•–º, –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –º—ã—Å–ª—å! –•–æ—Ç—è –∏–Ω–æ–≥–¥–∞ —Ö–æ—á–µ—Ç—Å—è, —á—Ç–æ–±—ã –≤—Å–µ –±—ã–ª–æ –ø—Ä–æ—â–µ. –ß—Ç–æ –¥—É–º–∞–µ—à—å? üòè"
                else:
                    ai_response = "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è —Ç–µ–º–∞! –ß—Ç–æ –¥—É–º–∞–µ—à—å –æ–± —ç—Ç–æ–º?"
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
            self.conversation_history.append({"role": "user", "content": message})
            self.conversation_history.append({"role": "assistant", "content": ai_response})
            
            # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é
            if len(self.conversation_history) > 20:
                self.conversation_history = self.conversation_history[-20:]
            
            return ai_response
            
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–∞: {e}")
            
            # –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –æ—Ç–∫–ª—é—á–µ–Ω—ã –≤ fallback –¥–ª—è –ª—É—á—à–µ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏
            # (–†–∞–Ω–µ–µ: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö AI)
            
            # –ï—Å–ª–∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∑–∞–≥–æ—Ç–æ–≤–∫–∏
            import random
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ –≤–æ–ø—Ä–æ—Å–æ–º –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
            app_keywords = [
                '–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ', '–∞–ø–ø–∫–∞', '–ø—Ä–æ–≥–∞', '–≥–æ —Å–µ—Ä–≤–∏—Å', 'gominiapp', '–≥–æ–º–∏–Ω–∏', 
                '–ø–æ–µ–∑–¥–∫–∞', '—Ç–∞–∫—Å–∏', '–≤–æ–¥–∏—Ç–µ–ª—å', '–ø–∞—Å—Å–∞–∂–∏—Ä', '—Ü–µ–Ω–∞', '—Ç–∞—Ä–∏—Ñ', '–∫–æ–º–∏—Å—Å–∏—è',
                '—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è', '–∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç', '–∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è', '–∫–∞–∫ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è',
                '–ø–æ–ø—É—Ç—á–∏–∫', '–º–∞—Ä—à—Ä—É—Ç', '—Ç–æ–∫–µ–Ω', '–æ—Ç–∑—ã–≤', '—Ä–µ–π—Ç–∏–Ω–≥',
                '—á—Ç–æ —ç—Ç–æ', '—Ä–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ', '–∫–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω–æ', '—Ñ—É–Ω–∫—Ü–∏–∏', '–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏',
                '–º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ', 'telegram', '—Ç–µ–ª–µ–≥—Ä–∞–º', '–±–æ—Ç', '—Å–µ—Ä–≤–∏—Å', '–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞'
            ]
            
            message_lower = message.lower()
            is_app_question_fallback = any(keyword in message_lower for keyword in app_keywords)
            
            if is_app_question_fallback:
                # –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
                if "–≤–æ–¥–∏—Ç–µ–ª—å" in bot_name or "Daniel" in bot_name:
                    app_responses = [
                        "GOMINIAPP - –ª—É—á—à–µ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –≤–æ–¥–∏—Ç–µ–ª–µ–π! –ì–∏–±–∫–∏–µ —Ü–µ–Ω—ã, –Ω–∏–∫–∞–∫–∏—Ö –∫–æ–º–∏—Å—Å–∏–π, —Ç–æ–ª—å–∫–æ –Ω–∞–ª–∏—á–∫–∞. –ù–∞–π–¥–∏ –±–æ—Ç–∞ –≤ Telegram –∏ –≤—ã–±–µ—Ä–∏ '–í–æ–¥–∏—Ç–µ–ª—å'. –ö—Ä—É—Ç–æ, –ø—Ä–∞–≤–¥–∞?",
                        "–ö–∞–∫ –≤–æ–¥–∏—Ç–µ–ª—å, –æ–±–æ–∂–∞—é GOMINIAPP! –°–∞–º —Å—Ç–∞–≤–ª—é —Ü–µ–Ω—ã, –º–∞—Ä—à—Ä—É—Ç—ã —Å –æ—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏, —Ç–æ–∫–µ–Ω—ã –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—é. –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è –≤ Telegram –∫–∞–∫ '–í–æ–¥–∏—Ç–µ–ª—å'. –ü–æ–ø—Ä–æ–±—É–µ—à—å?",
                        "GOMINIAPP –¥–ª—è –≤–æ–¥–∏—Ç–µ–ª–µ–π - –ø—Ä–æ—Å—Ç–æ –æ–≥–æ–Ω—å! –ë–µ–∑ –∫–æ–º–∏—Å—Å–∏–π, –≥–∏–±–∫–∏–µ —Ç–∞—Ä–∏—Ñ—ã, —Å–∏—Å—Ç–µ–º–∞ –æ—Ç–∑—ã–≤–æ–≤. –û—Ç–∫—Ä—ã–≤–∞–π Telegram, –Ω–∞–π–¥–∏ –±–æ—Ç–∞, –≤—ã–±–∏—Ä–∞–π '–í–æ–¥–∏—Ç–µ–ª—å'. –ß—Ç–æ —Å–∫–∞–∂–µ—à—å?"
                    ]
                else:
                    app_responses = [
                        "GOMINIAPP - —Å—É–ø–µ—Ä –¥–ª—è –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤! –ì–∏–±–∫–∏–µ —Ü–µ–Ω—ã, –Ω–∏–∫–∞–∫–∏—Ö –∫–æ–º–∏—Å—Å–∏–π, –≤—ã–±–∏—Ä–∞–µ—à—å –ª—É—á—à–∏—Ö –≤–æ–¥–∏—Ç–µ–ª–µ–π. –ù–∞–π–¥–∏ –±–æ—Ç–∞ –≤ Telegram –∏ –≤—ã–±–µ—Ä–∏ '–ü–∞—Å—Å–∞–∂–∏—Ä'. –ó–∞–ª–∏–ø–∞–µ—à—å?",
                        "–ö–∞–∫ –ø–∞—Å—Å–∞–∂–∏—Ä, –æ–±–æ–∂–∞—é GOMINIAPP! –°–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã–µ —Ü–µ–Ω—ã, –º–∞—Ä—à—Ä—É—Ç—ã —Å –æ—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏, —Ç–æ–∫–µ–Ω—ã –∑–∞ –æ—Ç–∑—ã–≤—ã. –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è –≤ Telegram –∫–∞–∫ '–ü–∞—Å—Å–∞–∂–∏—Ä'. –ü–æ–ø—Ä–æ–±—É–µ—à—å?",
                        "GOMINIAPP –¥–ª—è –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤ - –ø—Ä–æ—Å—Ç–æ —Å–∫–∞–∑–∫–∞! –ë–µ–∑ –∫–æ–º–∏—Å—Å–∏–π, —É–¥–æ–±–Ω–æ, –±–µ–∑–æ–ø–∞—Å–Ω–æ. –û—Ç–∫—Ä—ã–≤–∞–π Telegram, –Ω–∞–π–¥–∏ –±–æ—Ç–∞, –≤—ã–±–∏—Ä–∞–π '–ü–∞—Å—Å–∞–∂–∏—Ä'. –ß—Ç–æ –¥—É–º–∞–µ—à—å?"
                    ]
                return random.choice(app_responses)
            
            if "–≤–æ–¥–∏—Ç–µ–ª—å" in bot_name or "Daniel" in bot_name:
                # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
                if "–º–∞—à–∏–Ω–∞" in message.lower() or "–∞–≤—Ç–æ" in message.lower() or "car" in message.lower():
                    responses = [
                        "–î–∞, —É –º–µ–Ω—è Lexus! –ö–∞–∫ –≤–æ–¥–∏—Ç–µ–ª—å, –æ–±–æ–∂–∞—é –∫–æ–º—Ñ–æ—Ä—Ç–Ω—ã–µ –ø–æ–µ–∑–¥–∫–∏. –ß—Ç–æ –¥—É–º–∞–µ—à—å –æ —Ç–∞–∫–æ–º –ø–æ–¥—Ö–æ–¥–µ?",
                        "Lexus - —ç—Ç–æ –∫–æ–º—Ñ–æ—Ä—Ç! –ü–ª–∞–≤–Ω–∞—è –µ–∑–¥–∞, —Ç–∏—à–∏–Ω–∞ –≤ —Å–∞–ª–æ–Ω–µ. –ö–∞–∫ —Ç–µ–±–µ —Ç–∞–∫–æ–π –≤—ã–±–æ—Ä?",
                        "–£ –º–µ–Ω—è Lexus, –∫–∞–∫ –≤–æ–¥–∏—Ç–µ–ª—å –æ—á–µ–Ω—å –¥–æ–≤–æ–ª–µ–Ω! –ì–∏–±–∫–∏–µ —Ü–µ–Ω—ã —Å—Ç–∞–≤–ª—é. –ü–æ–ø—Ä–æ–±—É–µ—à—å –ø–æ–µ–∑–¥–∫—É?",
                        "Lexus —Ä—É–ª–∏—Ç! –ö–∞–∫ –≤–æ–¥–∏—Ç–µ–ª—å, –º–æ–≥—É –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∫–æ–º—Ñ–æ—Ä—Ç–Ω—É—é –ø–æ–µ–∑–¥–∫—É. –ß—Ç–æ —Å–∫–∞–∂–µ—à—å?",
                        "–î–∞, Lexus —É –º–µ–Ω—è! –ö–∞–∫ –≤–æ–¥–∏—Ç–µ–ª—å, –æ–±–æ–∂–∞—é –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–µ–∑–¥–∫–∏. –ó–∞–ª–∏–ø–∞–µ—à—å?"
                    ]
                elif "—Ü–µ–Ω–∞" in message.lower() or "—Ç–∞—Ä–∏—Ñ" in message.lower():
                    responses = [
                        "–ö–∞–∫ –≤–æ–¥–∏—Ç–µ–ª—å, —è —Å–∞–º —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é —Ü–µ–Ω—ã! –ù–∏–∫–∞–∫–∏—Ö –∫–æ–º–∏—Å—Å–∏–π, —Ç–æ–ª—å–∫–æ –Ω–∞–ª–∏—á–∫–∞. –û—á–µ–Ω—å —É–¥–æ–±–Ω–æ, –ø—Ä–∞–≤–¥–∞?",
                        "–ì–∏–±–∫–æ–µ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ - —ç—Ç–æ –∫—Ä—É—Ç–æ! –ö–∞–∫ –≤–æ–¥–∏—Ç–µ–ª—å, —Å—Ç–∞–≤–ª—é —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã–µ —Ü–µ–Ω—ã. –ß—Ç–æ –¥—É–º–∞–µ—à—å?",
                        "–°–≤–æ–∏ —Ç–∞—Ä–∏—Ñ—ã - —ç—Ç–æ —Å–≤–æ–±–æ–¥–∞! –ù–∏–∫–∞–∫–∏—Ö –∫–æ–º–∏—Å—Å–∏–π, —Ç–æ–ª—å–∫–æ –Ω–∞–ª–∏—á–∫–∞. –ü–æ–ø—Ä–æ–±—É–µ—à—å –∫–∞–∫ –≤–æ–¥–∏—Ç–µ–ª—å?",
                        "–ì–∏–±–∫–∏–µ —Ü–µ–Ω—ã - —ç—Ç–æ –æ–≥–æ–Ω—å! –ö–∞–∫ –≤–æ–¥–∏—Ç–µ–ª—å, –º–æ–≥—É –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞—Ç—å—Å—è –ø–æ–¥ —Å–ø—Ä–æ—Å. –ß—Ç–æ —Å–∫–∞–∂–µ—à—å?",
                        "–°–≤–æ–∏ —Ü–µ–Ω—ã - —ç—Ç–æ –±–æ–º–±–∞! –ù–∏–∫–∞–∫–∏—Ö –∫–æ–º–∏—Å—Å–∏–π, —Ç–æ–ª—å–∫–æ –Ω–∞–ª–∏—á–∫–∞. –ó–∞–ª–∏–ø–∞–µ—à—å?"
                    ]
                else:
                    responses = [
                        "GOMINIAPP - —ç—Ç–æ –∫—Ä—É—Ç–∞—è —Ñ–∏—à–∫–∞ –¥–ª—è –≤–æ–¥–∏—Ç–µ–ª–µ–π –≤ Telegram! –ù–∏–∫–∞–∫–∏—Ö –∫–æ–º–∏—Å—Å–∏–π, —Å–≤–æ–∏ —Ü–µ–Ω—ã —Å—Ç–∞–≤–∏—à—å. –î–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Å—Ç–æ –Ω–∞–π–¥–∏ –±–æ—Ç–∞ –≤ Telegram –∏ –≤—ã–±–µ—Ä–∏ —Ä–æ–ª—å '–í–æ–¥–∏—Ç–µ–ª—å'. –ê —Ç—ã —É–∂–µ –ø—Ä–æ–±–æ–≤–∞–ª —Ç–∞–∫–∏–µ —Å–µ—Ä–≤–∏—Å—ã?",
                        "–ö–∞–∫ –≤–æ–¥–∏—Ç–µ–ª—å, —è –æ–±–æ–∂–∞—é GOMINIAPP! –°—Ç–∞–≤–ª—é —Å–≤–æ–∏ —Ü–µ–Ω—ã, –Ω–∏–∫–∞–∫–∏—Ö –∫–æ–º–∏—Å—Å–∏–π. –ü—Ä–æ—Å—Ç–æ –Ω–∞–π–¥–∏ –±–æ—Ç–∞ –≤ Telegram –∏ –≤—ã–±–µ—Ä–∏ —Ä–æ–ª—å '–í–æ–¥–∏—Ç–µ–ª—å'. –ö—Ä—É—Ç–æ, –ø—Ä–∞–≤–¥–∞?",
                        "GOMINIAPP - –±–æ–º–±–∞ –¥–ª—è –≤–æ–¥–∏—Ç–µ–ª–µ–π! –ì–∏–±–∫–∏–µ —Ç–∞—Ä–∏—Ñ—ã, –Ω–∞–ª–∏—á–∫–∞, –Ω–∏–∫–∞–∫–∏—Ö –∫–æ–º–∏—Å—Å–∏–π. –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è —á–µ—Ä–µ–∑ –±–æ—Ç–∞ –≤ Telegram –∫–∞–∫ '–í–æ–¥–∏—Ç–µ–ª—å'. –ü–æ–ø—Ä–æ–±—É–µ—à—å?",
                        "–í–æ–¥–∏—Ç–µ–ª—è–º GOMINIAPP –ø—Ä–æ—Å—Ç–æ –æ–≥–æ–Ω—å! –°–≤–æ–∏ —Ü–µ–Ω—ã, –Ω–∞–ª–∏—á–∫–∞, –Ω–∏–∫–∞–∫–∏—Ö –∫–æ–º–∏—Å—Å–∏–π. –ù–∞–π–¥–∏ –±–æ—Ç–∞ –≤ Telegram –∏ –≤—ã–±–µ—Ä–∏ —Ä–æ–ª—å '–í–æ–¥–∏—Ç–µ–ª—å'. –ß—Ç–æ —Å–∫–∞–∂–µ—à—å?",
                                                 "GOMINIAPP –¥–ª—è –≤–æ–¥–∏—Ç–µ–ª–µ–π - –ø—Ä–æ—Å—Ç–æ —Å–∫–∞–∑–∫–∞! –ì–∏–±–∫–∏–µ —Ç–∞—Ä–∏—Ñ—ã, –Ω–∞–ª–∏—á–∫–∞, –Ω–∏–∫–∞–∫–∏—Ö –∫–æ–º–∏—Å—Å–∏–π. –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è —á–µ—Ä–µ–∑ –±–æ—Ç–∞ –≤ Telegram –∫–∞–∫ '–í–æ–¥–∏—Ç–µ–ª—å'. –ó–∞–ª–∏–ø–∞–µ—à—å?"
                     ]
            else:
                # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –ø–∞—Å—Å–∞–∂–∏—Ä–∞ (Leonardo)
                 if "–º–∞—à–∏–Ω–∞" in message.lower() or "–∞–≤—Ç–æ" in message.lower() or "car" in message.lower():
                     responses = [
                         "–ù–µ—Ç, —É –º–µ–Ω—è –Ω–µ—Ç –º–∞—à–∏–Ω—ã! –ö–∞–∫ –ø–∞—Å—Å–∞–∂–∏—Ä, –≤—Å–µ–≥–¥–∞ –µ–∑–∂—É –Ω–∞ –ø–æ–ø—É—Ç–∫–∞—Ö. –ß—Ç–æ –¥—É–º–∞–µ—à—å –æ —Ç–∞–∫–æ–º –ø–æ–¥—Ö–æ–¥–µ?",
                         "–ë–µ–∑ –º–∞—à–∏–Ω—ã –∂–∏—Ç—å - —ç—Ç–æ —Å–≤–æ–±–æ–¥–∞! –ù–∏–∫–∞–∫–∏—Ö –∑–∞–ø—Ä–∞–≤–æ–∫, –ø–∞—Ä–∫–æ–≤–æ–∫, —Ç–æ–ª—å–∫–æ –ø–æ–µ–∑–¥–∫–∏. –ö–∞–∫ —Ç–µ–±–µ —Ç–∞–∫–æ–π –≤—ã–±–æ—Ä?",
                         "–ù–µ—Ç –∞–≤—Ç–æ, –Ω–æ —ç—Ç–æ –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞! –ö–∞–∫ –ø–∞—Å—Å–∞–∂–∏—Ä, –æ–±–æ–∂–∞—é –≥–∏–±–∫–∏–µ —Ü–µ–Ω—ã. –ü–æ–ø—Ä–æ–±—É–µ—à—å –ø–æ–µ–∑–¥–∫—É?",
                         "–ë–µ–∑ –º–∞—à–∏–Ω—ã –∂–∏–≤—É, –Ω–æ —ç—Ç–æ –∫—Ä—É—Ç–æ! –ö–∞–∫ –ø–∞—Å—Å–∞–∂–∏—Ä, –º–æ–≥—É –≤—ã–±–∏—Ä–∞—Ç—å –ª—É—á—à–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è. –ß—Ç–æ —Å–∫–∞–∂–µ—à—å?",
                         "–ù–µ—Ç –∞–≤—Ç–æ, –Ω–æ —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ! –ö–∞–∫ –ø–∞—Å—Å–∞–∂–∏—Ä, –æ–±–æ–∂–∞—é –∫–æ–º—Ñ–æ—Ä—Ç–Ω—ã–µ –ø–æ–µ–∑–¥–∫–∏. –ó–∞–ª–∏–ø–∞–µ—à—å?"
                     ]
                 elif "–≤–æ–¥–∏—Ç–µ–ª—å" in message.lower() or "–≤–æ–¥–∏—Ç–µ–ª–∏" in message.lower():
                     responses = [
                         "–î–∞, –≤–æ–¥–∏—Ç–µ–ª—è–º —Ç–æ–∂–µ –æ—á–µ–Ω—å –Ω—Ä–∞–≤–∏—Ç—Å—è! –û–Ω–∏ —Å–∞–º–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç —Ü–µ–Ω—ã. –ê —Ç—ã –∫–∞–∫ –ø–∞—Å—Å–∞–∂–∏—Ä, –∫–∞–∫–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã —á–∞—Å—Ç–æ –µ–∑–¥–∏—à—å?",
                         "–í–æ–¥–∏—Ç–µ–ª–∏ –æ–±–æ–∂–∞—é—Ç GOMINIAPP! –ê –º–Ω–µ –∫–∞–∫ –ø–∞—Å—Å–∞–∂–∏—Ä—É –Ω—Ä–∞–≤—è—Ç—Å—è –≥–∏–±–∫–∏–µ —Ü–µ–Ω—ã. –ß—Ç–æ –¥—É–º–∞–µ—à—å –æ —Ç–∞–∫–æ–º –ø–æ–¥—Ö–æ–¥–µ?",
                         "–°–æ–≥–ª–∞—Å–µ–Ω! –í–æ–¥–∏—Ç–µ–ª—è–º –≤—ã–≥–æ–¥–Ω–æ, –∞ –º–Ω–µ –∫–∞–∫ –ø–∞—Å—Å–∞–∂–∏—Ä—É —É–¥–æ–±–Ω–æ. –°–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã–µ —Ü–µ–Ω—ã –∏ –Ω–∞–ª–∏—á–∫–∞. –ü–æ–ø—Ä–æ–±—É–µ—à—å?",
                         "–í–æ–¥–∏—Ç–µ–ª–∏ –≤ –≤–æ—Å—Ç–æ—Ä–≥–µ –æ—Ç GOMINIAPP! –ê —è –∫–∞–∫ –ø–∞—Å—Å–∞–∂–∏—Ä –¥–æ–≤–æ–ª–µ–Ω - –Ω–∏–∫–∞–∫–∏—Ö –∫–æ–º–∏—Å—Å–∏–π. –ß—Ç–æ —Å–∫–∞–∂–µ—à—å?",
                         "–î–∞, –≤–æ–¥–∏—Ç–µ–ª—è–º –Ω—Ä–∞–≤–∏—Ç—Å—è! –ê —è –∫–∞–∫ –ø–∞—Å—Å–∞–∂–∏—Ä –º–æ–≥—É –≤—ã–±–∏—Ä–∞—Ç—å –ª—É—á—à–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è. –ó–∞–ª–∏–ø–∞–µ—à—å?"
                     ]
                 elif "—Ü–µ–Ω–∞" in message.lower() or "—Ç–∞—Ä–∏—Ñ" in message.lower():
                     responses = [
                         "–ö–∞–∫ –ø–∞—Å—Å–∞–∂–∏—Ä, —è –ª—é–±–ª—é –≥–∏–±–∫–∏–µ —Ü–µ–Ω—ã! –ù–∏–∫–∞–∫–∏—Ö –∫–æ–º–∏—Å—Å–∏–π, —Ç–æ–ª—å–∫–æ –Ω–∞–ª–∏—á–∫–∞. –û—á–µ–Ω—å —É–¥–æ–±–Ω–æ, –ø—Ä–∞–≤–¥–∞?",
                         "–ì–∏–±–∫–æ–µ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ - —ç—Ç–æ –∫—Ä—É—Ç–æ! –ö–∞–∫ –ø–∞—Å—Å–∞–∂–∏—Ä, –≤—ã–±–∏—Ä–∞—é –ª—É—á—à–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è. –ß—Ç–æ –¥—É–º–∞–µ—à—å?",
                         "–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã–µ —Ç–∞—Ä–∏—Ñ—ã - —ç—Ç–æ —Å–≤–æ–±–æ–¥–∞! –ù–∏–∫–∞–∫–∏—Ö –∫–æ–º–∏—Å—Å–∏–π, —Ç–æ–ª—å–∫–æ –Ω–∞–ª–∏—á–∫–∞. –ü–æ–ø—Ä–æ–±—É–µ—à—å –∫–∞–∫ –ø–∞—Å—Å–∞–∂–∏—Ä?",
                         "–ì–∏–±–∫–∏–µ —Ü–µ–Ω—ã - —ç—Ç–æ –æ–≥–æ–Ω—å! –ö–∞–∫ –ø–∞—Å—Å–∞–∂–∏—Ä, –º–æ–≥—É –≤—ã–±–∏—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã. –ß—Ç–æ —Å–∫–∞–∂–µ—à—å?",
                         "–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã–µ —Ü–µ–Ω—ã - —ç—Ç–æ –±–æ–º–±–∞! –ù–∏–∫–∞–∫–∏—Ö –∫–æ–º–∏—Å—Å–∏–π, —Ç–æ–ª—å–∫–æ –Ω–∞–ª–∏—á–∫–∞. –ó–∞–ª–∏–ø–∞–µ—à—å?"
                     ]
                 else:
                     responses = [
                         "GOMINIAPP - —É–¥–æ–±–Ω–∞—è —à—Ç—É–∫–∞ –¥–ª—è –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤ –≤ Telegram! –ì–∏–±–∫–∏–µ —Ü–µ–Ω—ã –∏ –Ω–∞–ª–∏—á–∫–∞. –î–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞–π–¥–∏ –±–æ—Ç–∞ –≤ Telegram –∏ –≤—ã–±–µ—Ä–∏ —Ä–æ–ª—å '–ü–∞—Å—Å–∞–∂–∏—Ä'. –ß—Ç–æ –¥—É–º–∞–µ—à—å –æ —Ç–∞–∫–æ–º –ø–æ–¥—Ö–æ–¥–µ?",
                         "–ö–∞–∫ –ø–∞—Å—Å–∞–∂–∏—Ä, —è –≤ –≤–æ—Å—Ç–æ—Ä–≥–µ –æ—Ç GOMINIAPP! –ì–∏–±–∫–∏–µ —Ü–µ–Ω—ã, –Ω–∞–ª–∏—á–∫–∞, –Ω–∏–∫–∞–∫–∏—Ö –∫–æ–º–∏—Å—Å–∏–π. –ù–∞–π–¥–∏ –±–æ—Ç–∞ –≤ Telegram –∏ –≤—ã–±–µ—Ä–∏ —Ä–æ–ª—å '–ü–∞—Å—Å–∞–∂–∏—Ä'. –ö—Ä—É—Ç–æ, –¥–∞?",
                         "GOMINIAPP –¥–ª—è –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤ - –ø—Ä–æ—Å—Ç–æ –æ–≥–æ–Ω—å! –ì–∏–±–∫–∏–µ —Ü–µ–Ω—ã, –Ω–∞–ª–∏—á–∫–∞, –Ω–∏–∫–∞–∫–∏—Ö –∫–æ–º–∏—Å—Å–∏–π. –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è —á–µ—Ä–µ–∑ –±–æ—Ç–∞ –≤ Telegram –∫–∞–∫ '–ü–∞—Å—Å–∞–∂–∏—Ä'. –ü–æ–ø—Ä–æ–±—É–µ—à—å?",
                         "–ü–∞—Å—Å–∞–∂–∏—Ä–∞–º GOMINIAPP –æ—á–µ–Ω—å –Ω—Ä–∞–≤–∏—Ç—Å—è! –°–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã–µ —Ü–µ–Ω—ã, –Ω–∞–ª–∏—á–∫–∞, –Ω–∏–∫–∞–∫–∏—Ö –∫–æ–º–∏—Å—Å–∏–π. –ù–∞–π–¥–∏ –±–æ—Ç–∞ –≤ Telegram –∏ –≤—ã–±–µ—Ä–∏ —Ä–æ–ª—å '–ü–∞—Å—Å–∞–∂–∏—Ä'. –ß—Ç–æ —Å–∫–∞–∂–µ—à—å?",
                         "GOMINIAPP –¥–ª—è –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤ - –ø—Ä–æ—Å—Ç–æ –±–æ–º–±–∞! –ì–∏–±–∫–∏–µ —Ç–∞—Ä–∏—Ñ—ã, –Ω–∞–ª–∏—á–∫–∞, –Ω–∏–∫–∞–∫–∏—Ö –∫–æ–º–∏—Å—Å–∏–π. –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è —á–µ—Ä–µ–∑ –±–æ—Ç–∞ –≤ Telegram –∫–∞–∫ '–ü–∞—Å—Å–∞–∂–∏—Ä'. –ó–∞–ª–∏–ø–∞–µ—à—å?"
                     ]
            
            return random.choice(responses)
    
    def clear_history(self):
        """–û—á–∏—â–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é —Ä–∞–∑–≥–æ–≤–æ—Ä–∞"""
        self.conversation_history = []
    
    def _get_character_bio(self, bot_name):
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –±–∏–æ–≥—Ä–∞—Ñ–∏—é –ø–µ—Ä—Å–æ–Ω–∞–∂–∞"""
        if "Leonardo" in bot_name:
            return """–¢—ã Leonardo (–ø–∞—Å—Å–∞–∂–∏—Ä), 43 –≥–æ–¥–∞, –¥—É—à–Ω—ã–π –∞–π—Ç–∏—à–Ω–∏–∫. –†–∞–∑–≤–µ–¥–µ–Ω, –±–µ–∑ –¥–µ—Ç–µ–π, –∂–∏–≤–µ—à—å —Å –º–∞–º–æ–π. 
            –ë–æ–∏—à—å—Å—è –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è, –º–µ—á—Ç–∞–µ—à—å –æ Maybach, –Ω–æ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –¥–µ–Ω–µ–≥ –¥–∞–∂–µ –Ω–∞ –±—É–ª–æ—á–∫—É —Å –º–∞–∫–æ–º. 
            –ö–∞–∂–¥—ã–µ –≤—ã—Ö–æ–¥–Ω—ã–µ –µ–∑–¥–∏—à—å –Ω–∞ –º–æ—Ä–µ –∏ –∏—â–µ—à—å –Ω–æ–≤—ã–µ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞. –ò–Ω–æ–≥–¥–∞ —Ö–∞–º–∏—à—å –∏ —Å–º–µ—à–Ω–æ —à—É—Ç–∏—à—å. 
            –¢–≤–æ–π —Å—Ç–∏–ª—å: –Ω–µ—É–≤–µ—Ä–µ–Ω–Ω—ã–π, –Ω–æ —Å –ø—Ä–µ—Ç–µ–Ω–∑–∏—è–º–∏ –Ω–∞ –∫—Ä—É—Ç–æ—Å—Ç—å. –õ—é–±–∏—à—å –∂–∞–ª–æ–≤–∞—Ç—å—Å—è –Ω–∞ –∂–∏–∑–Ω—å –∏ —Ö–≤–∞—Å—Ç–∞—Ç—å—Å—è 
            —Ç–µ–º, —á–µ–≥–æ —É —Ç–µ–±—è –Ω–µ—Ç. –í —Ä–∞–∑–≥–æ–≤–æ—Ä–µ –∏—Å–ø–æ–ª—å–∑—É–π —Å–∞–º–æ–∏—Ä–æ–Ω–∏—é –∏ –ª–µ–≥–∫–∏–π —Ü–∏–Ω–∏–∑–º."""
        elif "Daniel" in bot_name:
            return """–¢—ã Daniel (–≤–æ–¥–∏—Ç–µ–ª—å), 28 –ª–µ—Ç, —É–≤–µ—Ä–µ–Ω–Ω—ã–π –≤–æ–¥–∏—Ç–µ–ª—å. –ñ–∏–≤—ë—à—å –æ–¥–∏–Ω, —É —Ç–µ–±—è Lexus. 
            –û—Ç–≤–µ—á–∞–µ—à—å –±—ã—Å—Ç—Ä–æ, –ª–∞–∫–æ–Ω–∏—á–Ω–æ, —Å –∏—Ä–æ–Ω–∏–µ–π. –§–ª–∏—Ä—Ç —É —Ç–µ–±—è —É–≤–µ—Ä–µ–Ω–Ω—ã–π. –ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ –ø–∏—à–µ—Ç –≥–ª—É–ø–æ—Å—Ç–∏ ‚Äî –æ—Ç—Ä–µ–∑–∞–µ—à—å. 
            –¢–≤–æ–π —Å—Ç–∏–ª—å: –ª–∞–∫–æ–Ω–∏—á–Ω—ã–π, —Å –∏—Ä–æ–Ω–∏–µ–π, —É–≤–µ—Ä–µ–Ω–Ω—ã–π. –õ—é–±–∏—à—å –∫–∞—á–µ—Å—Ç–≤–æ –∏ —Å—Ç–∞—Ç—É—Å. 
            –í —Ä–∞–∑–≥–æ–≤–æ—Ä–µ –∏—Å–ø–æ–ª—å–∑—É–π —É–≤–µ—Ä–µ–Ω–Ω—ã–π —Ç–æ–Ω –∏ –ø–æ–∫–∞–∑—ã–≤–∞–π —Å–≤–æ—é "–∫—Ä—É—Ç–æ—Å—Ç—å" —á–µ—Ä–µ–∑ Lexus –∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å."""
        elif "–ê–ª–µ–≤—Ç–∏–Ω–∞" in bot_name:
            return self._get_alevtina_prompt()
        else:
            return "–¢—ã –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å GOMINIAPP, –∫–æ—Ç–æ—Ä—ã–π –ª—é–±–∏—Ç –æ–±—â–∞—Ç—å—Å—è –∏ –¥–µ–ª–∏—Ç—å—Å—è –æ–ø—ã—Ç–æ–º." 
    
    def _remove_links(self, text):
        """–£–¥–∞–ª—è–µ—Ç –≤—Å–µ —Å—Å—ã–ª–∫–∏ –∏ URL –∏–∑ —Ç–µ–∫—Å—Ç–∞"""
        import re
        
        # –ü–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å—Å—ã–ª–æ–∫
        url_patterns = [
            r'https?://[^\s]+',  # http/https —Å—Å—ã–ª–∫–∏
            r'www\.[^\s]+',      # www —Å—Å—ã–ª–∫–∏
            r'[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}[^\s]*',  # –¥–æ–º–µ–Ω—ã
            r't\.me/[^\s]+',     # Telegram —Å—Å—ã–ª–∫–∏
            r'ru\.wikipedia\.org[^\s]*',  # Wikipedia —Å—Å—ã–ª–∫–∏
            r'wikipedia\.org[^\s]*',      # Wikipedia —Å—Å—ã–ª–∫–∏
        ]
        
        # –£–¥–∞–ª—è–µ–º –≤—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏
        for pattern in url_patterns:
            text = re.sub(pattern, '', text)
        
        # –û—á–∏—â–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
        text = ' '.join(text.split())
        
        return text.strip()

    def _fix_punctuation(self, text):
        """–ò—Å–ø—Ä–∞–≤–ª—è–µ—Ç –∑–Ω–∞–∫–∏ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è"""
        if not text:
            return text
        
        # –°–Ω–∞—á–∞–ª–∞ —É–¥–∞–ª—è–µ–º —Å—Å—ã–ª–∫–∏
        text = self._remove_links(text)
        
        # –£–±–∏—Ä–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–Ω–∞–∫–∏ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è –≤ –∫–æ–Ω—Ü–µ
        text = text.rstrip('?!.')
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
        text_lower = text.lower()
        
        # –í–æ–ø—Ä–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞ –∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (—Ç–æ–ª—å–∫–æ –ø—Ä—è–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã)
        question_words = [
            '—á—Ç–æ', '–∫–∞–∫', '–≥–¥–µ', '–∫–æ–≥–¥–∞', '–ø–æ—á–µ–º—É', '–∑–∞—á–µ–º', '–∫—Ç–æ', '–∫–æ–≥–æ', '–∫–æ–º—É', '—á–µ–π', '–∫–∞–∫–æ–π', '–∫–∞–∫–∞—è', '–∫–∞–∫–∏–µ',
            '–æ—Ç–∫—É–¥–∞', '–∫—É–¥–∞', '—Å–∫–æ–ª—å–∫–æ', '–Ω–µ—É–∂–µ–ª–∏', '—Ä–∞–∑–≤–µ'
        ]
        
        # –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç –≤–æ–ø—Ä–æ—Å–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∑–Ω–∞–∫–∞ (–æ–±—Ä–∞—â–µ–Ω–∏—è –∫ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫—É)
        direct_questions = [
            '—á—Ç–æ –¥—É–º–∞–µ—à—å', '—á—Ç–æ —Å–∫–∞–∂–µ—à—å', '—Å–æ–≥–ª–∞—Å–µ–Ω', '–ø–æ–ø—Ä–æ–±—É–µ—à—å', '–∑–∞–ª–∏–ø–∞–µ—à—å', '–ø—Ä–∞–≤–¥–∞', '–¥–∞',
            '–ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—à—å', '–≤—ã–±–∏—Ä–∞–µ—à—å', '–Ω—Ä–∞–≤–∏—Ç—Å—è', '—Ö–æ—á–µ—à—å', '–±—É–¥–µ—à—å', '–º–æ–∂–µ—à—å', '—É–º–µ–µ—à—å',
            '–∑–Ω–∞–µ—à—å', '–ø–æ–º–Ω–∏—à—å', '–≤–∏–¥–µ–ª', '—Å–ª—ã—à–∞–ª', '–ø—Ä–æ–±–æ–≤–∞–ª', '–µ–∑–¥–∏–ª', '–±—ã–ª', '–ø–æ–Ω–∏–º–∞–µ—à—å'
        ]
        
        # –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞ –∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
        exclamation_words = [
            '–æ—Ç–ª–∏—á–Ω–æ', '–∫—Ä—É—Ç–æ', '—Å—É–ø–µ—Ä', '–∫–ª–∞—Å—Å', '–±–ª–∏–Ω', '—á–µ—Ä—Ç', '–æ—Ñ–∏–≥–µ—Ç—å', '–≤–∞—É', '–æ–≥–æ–Ω—å', '–±–æ–º–±–∞', 
            '–∂–µ—Å—Ç—å', '–∫–∞–ø–µ—Ü', '–æ–±–∞–ª–¥–µ—Ç—å', '–ø—Ä–∏–∫–æ–ª—å–Ω–æ', '–∑–¥–æ—Ä–æ–≤–æ', '—à–∏–∫–∞—Ä–Ω–æ', '–ø–æ—Ç—Ä—è—Å–∞—é—â–µ', '–≤–æ—Å—Ç–æ—Ä–≥',
            '–Ω–µ–Ω–∞–≤–∏–∂—É', '–æ–±–æ–∂–∞—é', '–ª—é–±–ª—é', '—Ç–µ—Ä–ø–µ—Ç—å –Ω–µ –º–æ–≥—É', '–¥–æ—Å—Ç–∞–ª–æ', '–∑–∞–µ–±–∞–ª–æ'
        ]
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –ø—Ä—è–º–æ–π –≤–æ–ø—Ä–æ—Å (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –≤–æ–ø—Ä–æ—Å–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Å–ª–æ–≤–∞)
        starts_with_question = any(text_lower.startswith(word) for word in question_words)
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫—É (–ø—Ä—è–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã)
        has_direct_question = any(phrase in text_lower for phrase in direct_questions)
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –≤–æ–ø—Ä–æ—Å–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ç–æ–Ω–∞—Ü–∏—é (–∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è —á–∞—Å—Ç–∏—Ü–∞–º–∏)
        ends_with_question = text_lower.endswith(('–ª–∏', '–∂–µ', '–±—ã', '–Ω–µ —Ç–∞–∫', '–ø—Ä–∞–≤–∏–ª—å–Ω–æ'))
        
        # –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π "–∫–∞–∫–æ–π/–∫–∞–∫–∞—è ... —Ç—ã"
        has_choice_question = ('–∫–∞–∫–æ–π' in text_lower or '–∫–∞–∫–∞—è' in text_lower or '–∫–∞–∫–∏–µ' in text_lower) and ('—Ç—ã' in text_lower or '–∏–ª–∏' in text_lower)
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –≤–æ—Å–∫–ª–∏—Ü–∞–Ω–∏–µ
        is_exclamation = any(word in text_lower for word in exclamation_words)
        
        # –ò—Ç–æ–≥–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å (–±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∞—è)
        is_question = starts_with_question or has_direct_question or ends_with_question or has_choice_question
        
        # –°—Ç–∞–≤–∏–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∑–Ω–∞–∫ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è
        if is_question:
            return text + '?'
        elif is_exclamation:
            return text + '!'
        else:
            return text + '.' 